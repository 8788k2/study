
# 에어컨 모델 구축을 어떻게 할 것인가??
## 질문 리스트

1. COP 알 수 있나?
2. 풍량에 비례해서 혹은 같은 수치로 실내 공기를 흡입하나?
3. 실외기가 소모하는 전력 따로 알 수 있나?
4. 실내기 핀-튜브 구조인지, 마이크로채널(평판 다공 튜브+루버드 핀) 구조인지!
![alt text](image-1.png)

5. 설정온도에 따른 적정 냉매온도 존재하는지, 어떻게 맞추는지 (설정온도 17도로 맞춰도 20~21도 맞추는 캐이스 있던데 왜그런건지)

6. 컬럼의 정확한 의미 필요, 중복되거나 의미불명인 컬럼이 너무 많음 

7. 실외기의 냉방용량 Q가 정해져있고 각 실내기의 냉방 이펙트 q_i는 실내기에 입력된 제어입력에 대한 함수로 할당받는 모델로 생각할 수 있을지


## 8월 22일 교수님 피드백

물리식 기반으로 파라미터 학습해서 환경 만들고 강화학습하는 구조로 진행

2차미분방정식으로 깔끔하게 식 정리 필요 (Tc를 밖으로 빼서 정리, 열부하도 상태 포함해서 정리)

안상태 교수님 측 학생들과 계속 실험 일정 공유, 소통, 분배해서 진행


## 1. 타우를 이용
$$ (-T_{con}+T_{id})e^{-t/tau} + T_{con}$$

$$ tau= -\alpha_1T_{id}-\alpha_2F_{run}+\alpha $$



## 협조제어 
단일 실내기로 온도 떨어트릴 수 없다면 협조제어로 더 빠르게 하강시키는 접근법 밖에 없음


실내기 두 대 있는 공간은 그럼 협조제어가 온도 하강에 미치는 효과를 실험하는 용도로 쓰면 어때? 


## PINN + 잔차학습 구조
Physics informed 구조로 학습한 베이스 모델 두고 공간이 달라져서 생기는 오차를 잔차학습으로 빠르게 달성하는 구조는 어때?

gray-box model

그럴려면 공간 특성에 따라 결정되는 계수등을 확실히 정의, 분리하고, 다른 공간에 대한 실험으로 검증하는 계획 세워야 해


교수님께 보낼 피피티에 실험 계획과 근거 포함시키기



## 최적 풍속 구하기
$U$: 열전달계수 $(W/m^2\cdot K)$

$A$: 기체가 파이프를 지나는 동안 접촉하는 총 면적

$\dot{m}$: 기체의 유량, $v$: 유속, $L$:파이프의 길이 

공기가 파이프를 통과하는데 걸리는 체류시간을 
$\frac{L}{v}$이라고 하면 아래의 등식이 성립한다.

$$Q=UA\Delta T_{im}\cdot \frac{L}{v}$$
미소 시간에 대해 생각하면 아래와 같이 다시 쓸 수 있다. 

냉매와 공기의 온도차 만큼 미소 시간 동안, 미소면적에서 열이 전달된다고 본다.
$$\frac {dQ}{dt}=UA\cdot \frac {v\cdot dt}{L}(T_{ref}-T_{air})$$

전달된 열에너지가 공기의 온도변화로 쓰인다고 가정하면 아래와 같이 쓸 수 있다.

$$dQ=\dot{m}\cdot dt\cdot C_p \cdot dT_{air}$$

위 두 식을 정리하면 아래와 같은 식을 얻을 수 있다.

$$\frac {dT_{air}}{dt}= \frac {UAv}{\dot mC_pL} (T_{ref}-T_{air})$$

$T_{air}(0)=T_{{in}}$이라고 하면 

$$
T_{\mathrm{air}}(t) = T_{\mathrm{ref}} + \left( T_{\mathrm{in}} - T_{\mathrm{ref}} \right) \cdot \exp \left( -\frac{UA v}{\dot{m} C_p L} \cdot t \right)
$$

이제 공기가 관을 나올때의 온도를 유속에 대한 함수로 쓰면 아래와 같이 쓸 수 있다.
$$
T_{\mathrm{out}}(v) = T_{\mathrm{ref}} + \left( T_{\mathrm{in}} - T_{\mathrm{ref}} \right) \cdot \exp \left( -\frac{UA}{\dot{m} C_p} \right)
$$
한편 공기가 관을 나왔을 때 방출한 시간당 총 열량은 아래와 같이 쓸 수 있다. 
$$
Q(v) = \dot{m} \cdot C_p \cdot \left( T_{\mathrm{in}} - T_{\mathrm{out}}(v) \right)
$$

위 식에 $T_{out}$ 식을 대입하면 최종적으로 아래와 유량에 대한 단위시간당 열 방출량 식을 얻을 수 있다. 
$$
Q(\dot{m}) = \dot{m} C_p \left( T_{\mathrm{in}} - T_{\mathrm{ref}} \right) \left[ 1 - \exp \left( -\frac{UA}{\dot{m} C_p} \right) \right]
$$







## EEV 제어
주어진 실내 온도에서 과열도를 5~8도로 유지하면서도 공기의 원하는 토출온도가 되게 하는 냉매 유량을 결정

과열도가 크면 냉매가 냉방코일을 지나는 도중에 모두 다 기화하여 열 교환능력 떨어짐 

과열도가 작으면 냉매가 다 기화하지 않았을 가능성 있어서 고장의 원인이 됨 



파이프인 압력 = 로우 압력 (포화증기압 대비 낮았으므로) 

파이프 콤프레셔를 지난 냉매의 압력 = 하이 압력




같은 실외기를 공유하는 실내기의 열용량이 차이날 이유

공기와 냉매 배관이 닿는 면적이 더 크다, 냉매 유량이 더 크다, 공기 유량이 더 크다.




## Modeling and simulation analysis of multi-scenario air conditioning cluster response for intelligent load management in distribution networks (nature)

$$
T_{\text{indoor}}(t+\Delta t)
= T_{\text{indoor}}(t)
+ \frac{\Delta t}{k_c \cdot C_{\text{indoor}}}\,\bigl(Q_{\text{in}}-Q_{\text{loss}}\bigr)
$$

$$
Q_{\text{solar}} = A_{\text{window}} \cdot I_{\text{solar}} \cdot f_{\text{angle}}
$$

$$
Q_{\text{human}} = \mathrm{PDM}_{\text{act}} \cdot P_{\text{activity}}
$$

$$
Q_{\text{conductive}} = k_a \cdot A_{\text{exposed}} \cdot \bigl(T_{\text{outdoor}} - T_{\text{indoor}}\bigr)
$$

$$
Q_{\text{fresh}} = \dot{m}_{\text{fresh}} \cdot c_p \cdot \bigl(T_{\text{outdoor}} - T_{\text{indoor}}\bigr)
$$

$$
Q_{\text{in}} = k_s \cdot Q_{\text{solar}} + k_p \cdot Q_{\text{human}} + Q_{\text{conductive}} + Q_{\text{fresh}}
$$

$$
Q_{\text{wind}} = v_{\text{wind}} \cdot A_{\text{exposed}}
$$

$$
Q_{\text{loss}} = k_{\text{loss}} \cdot Q_{\text{wind}}
$$


## Dynamic Characteristics of an R410a Multi-split Variable Refrigerant Flow Air-conditioning System

### 압축기 모델

$$\textbf{체적효율}
\quad
\eta_v
= \kappa_0 + \kappa_1\varphi + \kappa_2\varphi^2
  + \kappa_3\,(p_{\mathrm{dis}}-p_{\mathrm{suc}})\,(1+\kappa_4\,p_{\mathrm{suc}})
\,,\qquad
\varphi := \frac{p_{\mathrm{dis}}}{p_{\mathrm{suc}}},
\quad
\kappa_i = a_{i,1}+a_{i,2}\,\bar{\omega}+a_{i,3}\,\bar{\omega}^2,
\quad
\bar{\omega}=\frac{f}{f_{\mathrm{nom}}}
$$


$$\textbf{소비 전력(축/전기)}
\quad
\dot{W}
= \zeta_1\,p_{\mathrm{suc}}\,\dot{V}_{\mathrm{suc}}\,
  \bigl(\varphi^{\zeta_2}-\zeta_3\bigr) + \zeta_4,
\qquad
\zeta_i = b_{i,1}+b_{i,2}\,\bar{\omega}+b_{i,3}\,\bar{\omega}^2
$$


$$\textbf{냉매에 흡수되는 전력 비율}
\quad
\lambda
= \theta_0 + \theta_1 \varphi + \theta_2 \varphi^2,
\qquad
\theta_i=c_{i,1}+c_{i,2}\,\bar{\omega}+c_{i,3}\,\bar{\omega}^2
$$

$$\textbf{질량유량}
\quad
\dot{m}=\eta_v\,\rho_{\mathrm{suc}}\,\dot{V}_{\mathrm{disp}}
\quad(\,= \rho_{\mathrm{suc}}\,\dot{V}_{\mathrm{suc}}\,)
$$

$$\textbf{토출 엔탈피}
\quad
h_{\mathrm{dis}}= \frac{\lambda\,\dot{W}}{\dot{m}} + h_{\mathrm{suc}}
$$



## 관에서 유동하는 유체의 에너지 보존에 관해
외부 열 유입이 없을 때

 -유입 유출되는 엔탈피 변화량 = 내부저장 엔탈피 변화량

외부 열 유입이 없으면 

 -유입 유출되는 엔탈피 변화량 + 벽면에서 유입되는 열에너지 = 내부 저장 엔탈피 변화량


### 필요한 파라미터 정리하기 

-> 알 수 있는 건 LG 측에 요구, 알 수 없는것들도 정리해 놓고 어떤 구조로 학습하면 좋을지 고민하기


$A_t$, $A_{fin}$, $\eta_{fin}$, 현실적인 $T_w$의 변화 모사, $\Delta Z$ or $\Delta T$(시간기준으로 한다면 길이대신 체류시간이 들어가야 할 것이므로)

실시간 습도 데이터는 있으니까 $W_{in}$은 알 수 있고 $w_{out}$을 어떻게 알 수 있을지 중요 --> 미분방정식으로부터 유도? 

그러면 온도와 습도 변화에 관한미분 방정식이 T_w에 대해서 정리된디

--> 그 시점의 적절한 대표 T_w를 구하는 방식만 알아낸다면 방이 잃는 열에너지 모델링 가능 

T_w를 스테이트로 보고 옵저버로 추론? (실내온습도 변화 데이터를 통해)

$$T_w = T_r +\theta$$

$$T_r = T_{sat}(p_{suction})$$ 

$$
T_{\mathrm{out}}
= T_c + \bigl(T_{\mathrm{in}} - T_c\bigr)\,e^{-\,K_s/\dot{m}_a}
$$

$$
\omega_{\mathrm{out}}
= \omega_{\mathrm{in}} + \bigl(\omega_{\mathrm{sat}}(T_c) - \omega_{\mathrm{in}}\bigr)\,\bigl(1 - e^{-\,K_m/\dot{m}_a}\bigr)
$$


$$
q_{\mathrm{tot}}
= \dot{m}_a \left[\, c_{p,a}\,(T_{\mathrm{in}} - T_{\mathrm{out}})
+ \Delta h_{fg}\,(\omega_{\mathrm{in}} - \omega_{\mathrm{out}}) \right]
= q_{\mathrm{sens}} + q_{\mathrm{lat}} 
$$



refrigerant property models for R410A were obtained from the Vapor Cycle Library v. 1.3



$$
q_{a,i}= \dot m_{a,i}c_p(1-e^{-k/\dot m_{a,i}})(T-T_{c,i})
$$

$$
\dot T
= -\left[\frac{1}{RC}+\sum_i \alpha_i(t)\right]\,T
\;+\; \frac{1}{RC}\,T_{\text{out}}
\;+\; \sum_i \alpha_i(t)\,T_{c,i}
\;+\; \frac{1}{C}\,(Q+w)
$$

$$
\alpha_i(t)\;\triangleq\; \frac{\dot m_{a,i}(t)\,c_p}{C}\,\eta_i\!\big(\dot m_{a,i}(t)\big)
\;=\; \frac{\dot m_{a,i}(t)\,c_p}{C}\left(1-e^{-\,k_i/\dot m_{a,i}(t)}\right)
$$

$$
\dot x
= A(\rho)\,x
+ B_{\text{out}}(\rho)\,T_{\text{out}}
+ \sum_i B_{c,i}(\rho)\,T_{c,i}
+ E\,(Q+w)
$$

파라미터는 풍량

```
지금 코드는 부피유량이 모두 건공기라고 가정 

실제로는 수증기와 건공기합으로 들어옴

현재 습도 이용해서 순수 건공기 질량으로 바꾸고 (파이프 온도에서의 포화습도 만큼만 수증기를 머금은 공기의 질량 구해서 최종 m)

코일 온도는 파이프인 아웃온도 사이값으로 간주하고 (파이프인 온도)

습도에 따른 잠열을 코일 온도에 더하면 어때 



```
## PINN
데이터손실 RC 모델 기반 외기온도 열평형항을 두고 실제 온도 변화로 냉방이펙트 정답 레이블 생성

데이터 손실

모델이 예측한 토출온도와 실제 토출온도 손실

토출온도를 이용한 냉방이펙트 계산과 모델이 예측한 냉방효과 손실 



## RC 모델

$$\dot T_{id}=aT_{od}+bT_{id}+c  $$

$$ T_{\infty}(t)=-\frac{a}{b}T_{od}(t) -\frac{c}{b} $$

$$ \dot T_{id}= \frac{1}{\tau}(T_{\infty}(t)-T_{id})  $$



## 통합모델


$$
\dot{T}_{\mathrm{in}}
= a\,T_{\mathrm{od}} + b\,T_{\mathrm{in}} + c
-\frac{1}{C_{\mathrm{air}}}
\sum_{i} \dot{m}_{a,i}\,c_p\!\left(1 - e^{-K_{s,i}/\dot{m}_{a,i}}\right)\!\left(T_{\mathrm{in}} - T_{c,i}\right)
$$


$$ 
\dot{T}_{\mathrm{in}}
= a\,T_{\mathrm{od}} + b\,T_{\mathrm{in}} + c
-\frac{1}{C_{\mathrm{air}}}
\sum_{i} \dot{m}_{a,i}\,c_p\!\left(T_{\mathrm{in}} - T_{out}\right)
$$

-->

$$ 
\dot{T}_{\mathrm{in}}
= \lambda_1\,T_{\mathrm{od}} + \lambda_2\,T_{\mathrm{in}} + \lambda_3
- \lambda_4
\sum_{i} \dot{m}_{a,i}\!\left(T_{\mathrm{in}} - T_{out}\right)
$$


## pinn 구조
좋아요. **지연(δ) 없이** 토출온도 $T_{out}$를 외생 입력으로 쓰는 **조건부 PINN**을 수학적 표기로 정리합니다.

---

# 1) 신호, 도메인, 파라미터

* 시간 도메인(단일 세션): $t\in[t_0,t_1]$. 다세션이면 $s=1,\dots,S$에 대해 각 구간 $[t_0^{(s)},t_1^{(s)}]$.
* 관측(외생) 신호
  $T_{od}(t)\in\mathbb{R}$, $\ \dot m_i(t)\in\mathbb{R}_{\ge0}\ (i=1..N)$, $\ T_{out,i}(t)\in\mathbb{R}.$
* 상수(알려짐): 비열 $c_p>0$.
* 미지 파라미터(식별 대상):
  $\Theta=\{\lambda_1,\lambda_2,\lambda_3,C_{\mathrm{air}}\}$ with $C_{\mathrm{air}}>0$.
  편의상 $\lambda_4:=\dfrac{c_p}{C_{\mathrm{air}}}>0$로 표기.

---

# 2) 지배 방정식(축약 ODE)

토출식 대수관계 $T_{out,i}=T_{c,i}+(T_{in}-T_{c,i})e^{-K_{s,i}/\dot m_i}$를 제거하면

$$
\dot T_{in}(t)
=\lambda_1\,T_{od}(t)+\lambda_2\,T_{in}(t)+\lambda_3
-\lambda_4\sum_{i=1}^N \dot m_i(t)\,\big(T_{in}(t)-T_{out,i}(t)\big).
\tag{1}
$$

---

# 3) PINN 근사와 입력 피처

* 신경망(조건부 해 연산자):
  $\hat T(t,x(t);\,\theta)\approx T_{in}(t)$.
* 입력 피처 벡터(외생):
  $x(t)=\big[T_{od}(t),\ \dot m_1(t),\ldots,\dot m_N(t),\ T_{out,1}(t),\ldots,T_{out,N}(t),\ s(t)\big]$.
  *(여기서 $s(t)$는 풍량 단계 등 선택적 범주/상태 피처; 넣지 않아도 무방합니다.)*
* 주의: $\partial_t\hat T$ 계산 시 $x(t)$는 **상수로 고정**(외생)하여 **편미분** $\partial_t\hat T(t,x)$만 사용합니다.

---

# 4) 잔차 정의

잔차 함수 $r:\,[t_0,t_1]\to\mathbb{R}$

$$
\begin{aligned}
r(t;\theta,\Theta)
&=\underbrace{\partial_t \hat T(t,x(t);\,\theta)}_{\text{시간에 대한 편미분}}
-\Big[\lambda_1 T_{od}(t)+\lambda_2 \hat T(t,x(t))
+\lambda_3\\
&\qquad\qquad\qquad\qquad
-\lambda_4 \sum_{i=1}^N \dot m_i(t)\big(\hat T(t,x(t))-T_{out,i}(t)\big)\Big].
\end{aligned}
\tag{2}
$$

---

# 5) 초기조건(IC)와(필요 시) 세션 처리

* 단일 세션 IC:

$$
\hat T(t_0,x(t_0))=T_{in}^{\mathrm{meas}}(t_0).
\tag{3}
$$

* 다세션일 때 세션 $s$마다

$$
\hat T\!\big(t_0^{(s)},x(t_0^{(s)})\big)=T_{in}^{\mathrm{meas}}\!\big(t_0^{(s)}\big),
\qquad s=1,\dots,S.
\tag{3s}
$$

경계조건(BC)은 별도 없음(시간 ODE). 주기 가정이 필요하면 $\hat T(t_0)=\hat T(t_1)$을 약한 제약으로 둘 수 있음.

---

# 6) 학습 데이터와 손실

* 관측 시각 집합: $\mathcal{T}_{\mathrm{data}}=\{t_k\}_{k=1}^{K}$.
* 콜로케이션(잔차) 시각: $\mathcal{T}_{\mathrm{res}}=\{\tau_j\}_{j=1}^{J}$.

손실 항:

$$
\mathcal{L}_{\mathrm{data}}
=\frac{1}{K}\sum_{t_k\in\mathcal{T}_{\mathrm{data}}}
\big(\hat T(t_k,x(t_k)) - T_{in}^{\mathrm{meas}}(t_k)\big)^2,
\tag{4}
$$

$$
\mathcal{L}_{\mathrm{res}}
=\frac{1}{J}\sum_{\tau_j\in\mathcal{T}_{\mathrm{res}}}
\big(r(\tau_j;\theta,\Theta)\big)^2,
\tag{5}
$$

$$
\mathcal{L}_{\mathrm{IC}}
=\frac{1}{S}\sum_{s=1}^{S}
\big(\hat T(t_0^{(s)},x(t_0^{(s)})) - T_{in}^{\mathrm{meas}}(t_0^{(s)})\big)^2
\quad(\text{단일 세션이면 }S=1),
\tag{6}
$$

(선택) 규제/물리 제약:

$$
\mathcal{L}_{\mathrm{phys}}
=\rho_4\,\mathbf{1}_{\{\lambda_4\le0\}}\,|\lambda_4|^2
\ +\ \rho_2\,\mathbf{1}_{\{\lambda_2>0\}}\,|\lambda_2|^2,
\tag{7}
$$

여기서 $\lambda_4=c_p/C_{\mathrm{air}}>0$, 통상 $\lambda_2<0$을 권장. (실제로는 양수 제약을 재매개변수화로 구현)

총 목표:

$$
\min_{\theta,\Theta}\ 
\mathcal{L}_{\mathrm{tot}}
=\alpha_{\mathrm{data}}\mathcal{L}_{\mathrm{data}}
+\alpha_{\mathrm{res}}\mathcal{L}_{\mathrm{res}}
+\alpha_{\mathrm{IC}}\mathcal{L}_{\mathrm{IC}}
+\alpha_{\mathrm{phys}}\mathcal{L}_{\mathrm{phys}}.
\tag{8}
$$

---

# 7) 출력 및 식별값의 해석

* 추정된 해: $\hat T(t,x(t);\hat\theta)$.
* 식별 파라미터: $\hat\lambda_1,\hat\lambda_2,\hat\lambda_3,\hat C_{\mathrm{air}}$ (또는 $\hat\lambda_4=c_p/\hat C_{\mathrm{air}}$).
* 물리적 의미: $\hat C_{\mathrm{air}}=c_p/\hat\lambda_4>0$ (공기/실내 유효 열용량), $\hat\lambda_2$는 실내 자체 동특성(자연 냉각/가열) 계수 등.

---

### 메모

* 외생 입력 $x(t)$는 **미분 경로에서 고정**(편미분 $\partial_t\hat T$만 사용).
* 다세션 학습 시 서로 다른 운전 조건(유량/토출/외기)을 혼합하여 \*\*지속적 흥분(PE)\*\*을 확보하면 식별성이 좋아집니다.
* 선택적으로 적분 일치(에너지 보존) 제약을 추가하면 노이즈에 더 강해집니다.




---


요점만 딱 정리할게.

## 1) A안이 “기본 PINN”이냐?

맞아. A안은

$$
\hat T_\phi(t,u)\;\text{를 직접 근사하고},\quad
\mathcal L_{\text{phys}}=\big\|\partial_t\hat T_\phi-f(\hat T_\phi,u;\lambda)\big\|^2
$$

로 **해(궤적)와 미지 파라미터 $\lambda$** 를 동시에 찾는 **정석 PINN** 형태야. 시각 $t$를 넣으면 그때의 온도 값을 바로 돌려주는 “필드 근사” 스타일.

---

## 2) B안(전이식/IRK-PINN)은 MDP로 쓰기 좋음

우리가 제어·롤아웃에 쓰려면 **전이식**

$$
T_{k+1}=g_\Theta(T_k,u_k)
$$

이 필요해. 연속식

$$
\dot T=\lambda_1T_{od}+(\lambda_2-\lambda_4S_{\dot m})T+\lambda_3+\lambda_4S_{\dot mT_b}
$$

을 IRK로 이산화하면(상세 스킵) $T_k, u_k$만으로 $T_{k+1}$이 정해져. 이게 **마르코프** 구조라서 예측도, 제어도 바로 연결돼.

* 상태: $T_k$
* 외생입력(또는 제어): $u_k$ (= $T_{od},\,S_{\dot m},\,S_{\dot mT_b}$의 스테이지 값)
* 전이: IRK 단계 방정식과 출력식으로 $T_{k+1}$ 계산
* PINN은 단계 상태 $Y^{(j)}$나 $f(\cdot)$를 내고 **IRK 잔차**를 손실로 묶어 학습

---

## 3) B안에서 “누수 방지”는 이렇게

핵심은 **입력 $u$** 를 **실내온도 $T$** 와 **독립**으로 만드는 것. 즉,

$$
M=\sum\dot m_i(T-T_{bdy,i})\ \text{(금지)}
\quad\Rightarrow\quad
S_{\dot m}=\sum\dot m_i,\;\; S_{\dot mT_b}=\sum\dot m_iT_{bdy,i}\ \text{(허용)}
$$

을 쓰고, **스테이지 입력** $u_{k}^{(1,2)}=(T_{od}^{(1,2)}, S_{\dot m}^{(1,2)}, S_{\dot mT_b}^{(1,2)})$는 **실내온도 없이** 센서에서 바로 만든다.

그다음이 포인트:

* **학습 중** 한 스텝 전이 학습을 할 때 $T_k$를 **입력으로 쓰는 건 누수 아님**. 그건 **현재 상태**고, 예측 대상은 $T_{k+1}$이니까 정당해.
* 다만 “실측 $T_k$ 의존”을 줄여 **오픈루프 일반화**를 키우려면, **멀티스텝 롤아웃 손실**을 섞어라:

  $$
  \hat T_{k+1}=g(\hat T_k,u_k),\quad
  \hat T_{k+2}=g(\hat T_{k+1},u_{k+1}),\ \ldots
  $$

  으로 **중간에 실측 $T$를 넣지 않고**(teacher forcing X) 여러 호라이즌(2,4,8 step)에서 데이터 로스를 같이 줄이면, 모델이 “자기 예측으로 굴러가는” 상황에 강해진다.
* 정리: **입력 $u$** 에는 $T$가 없다(완전 분리). **상태 $T_k$** 는 전이식의 정당한 인자이며, 학습·평가 시에는 가능한 한 **예측값 $\hat T_k$** 로 굴려서(오픈루프) 일반화를 확보.

---

## 4) 두 방식 차이와 장단점 한 줄 비교

* **A(필드 근사 PINN)**: $t,u\mapsto T$. **점값 맞추기 쉬움**, 데이터 적어도 학습 용이.
  단, **전이/MDP가 없음** → 제어·롱롤아웃 보장은 약함.
* **B(IRK 전이 PINN)**: $(T_k,u_k)\mapsto T_{k+1}$. **마르코프 전이 제공**, 오픈루프·제어에 직결.
  학습은 조금 까다롭지만, **장기·외삽 안정성**이 강함.

우리 목적(예측+제어)은 **B안**으로 가되,

* $u=(T_{od},S_{\dot m},S_{\dot mT_b})$만 사용(누수 차단),
* 데이터 로스(1-step) + **IRK 잔차** + **멀티스텝 데이터 로스**로 학습,
* 평가도 **오픈루프 롤아웃** 중심으로 가면 PINN의 장점이 뚜렷해진다.
